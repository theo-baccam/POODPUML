#include <vector>
#include <flecs.h>
#include "LevelBuilder.hpp"
#include "flecs_ids.hpp"


LevelBuilder::LevelBuilder() {}
LevelBuilder::~LevelBuilder() {}

void LevelBuilder::buildEasyLevel(flecs::world &world) {
    const unsigned int mapDimensions = 16;

    for (int y = 0; y < mapDimensions; y++) {
        for (int x = 0; x < mapDimensions; x++) {
            world.entity()
                .add<FloorTag>()
                .set<Position>({(double) x, (double) y});
        };
    };
}

void LevelBuilder::buildMediumLevel(flecs::world &world) {
    const char map[] =
        ".........#######........\n"
        ".......###########......\n"
        "...################.....\n"
        "..##################....\n"
        ".####################...\n"
        ".#########...########...\n"
        ".#######......########..\n"
        "########......#########.\n"
        "############..####..####\n"
        "##################..####\n"
        "######....#########..##.\n"
        "######......#######..##.\n"
        "######################..\n"
        "#########.###########...\n"
        ".######...##########....\n"
        ".######..########.......\n"
        "..#############.........\n"
        "..#############.........\n"
        ".......#########........\n"
        ".....#############......\n"
        "..################......\n"
        "..##################....\n"
        "...#################....\n"
        "....####....######......";

    int x = 0;
    int y = 0;
    for (char c : map) {
        if (c == '#') {
            world.entity()
                .add<FloorTag>()
                .set<Position>({(double) x, (double) y});
        } else if (c == '\n') {
            x = 0;
            y++;
        }
        x++;
    };
}

void LevelBuilder::buildHardLevel(flecs::world &world) {
    const char map[] =
        "..........................................####..................\n"
        "...................................##############...............\n"
        ".........................########################...............\n"
        "..................#################.##############..............\n"
        "...........################.........########....................\n"
        "####################................##..........................\n"
        "###################................###..........................\n"
        "####################...............###..........................\n"
        ".............############....###########........#####...........\n"
        ".................##########################...########..........\n"
        "........................######...#######################........\n"
        ".................................########################.......\n"
        "..................................########################......\n"
        "...................................#######################......\n"
        "...................................######################.......\n"
        "..........##############..........#######################.......\n"
        "......########################...#########################......\n"
        ".....################...###################....############.....\n"
        "......###############........##########............#########....\n"
        ".........###############........###.....................###.....\n"
        ".........###.......#######.....###..............####...###......\n"
        "..........##.........#####......###.......#################.....\n"
        ".......######........############################..#########....\n"
        "....############.###########################..........######....\n"
        "...###################..####################...........####.....\n"
        "...##########.####......####################............##......\n"
        "....#########............###################...........###......\n"
        "....#########............###################..........###.......\n"
        "....########..............#####################....########.....\n"
        "....########................##############.################.....\n"
        ".....###.......................##########......####...#####.....\n"
        "................................................................";

    int x = 0;
    int y = 0;
    for (char c : map) {
        if (c == '#') {
            world.entity()
                .add<FloorTag>()
                .set<Position>({(double) x, (double) y});
        } else if (c == '\n') {
            x = 0;
            y++;
        }
        x++;
    };
}